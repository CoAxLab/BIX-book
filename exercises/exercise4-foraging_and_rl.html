

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exercise 4: Foraging and reinforcement learning &#8212; Biologically Intelligent eXploration (BIX)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exercises/exercise4-foraging_and_rl';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Exercise 3: CBGT networks and predator-prey dynamics" href="exercise3-cbgt_and_pred_prey.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/levy-flight.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/levy-flight.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Biologically Intelligent eXploration (BIX)
                </a>
            </li>
        </ul>
        <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notebooks/intro-python.html">Introduction to python</a></li>

</ul>
<p class="caption"><span class="caption-text">Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab1-information.html">Lab 1- Information theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab2-explorelib.html">Lab 2 - Random exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab3-chemotaxis.html">Lab 3 - Chemotaxis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab4-evidence_accumulation.html">Lab 4 - Evidence Accumulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab5-cbgt.html">Lab 5 - CBGT pathways</a></li>

<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab6-predator_prey.html">Lab 6 - Predator-prey dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab7-foraging.html">Lab 7 - Foraging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab8-infotaxis.html">Lab 8 - Infotaxis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lab9-reward_seeking.html">Lab 9 - Reward seeking</a></li>
</ul>
<p class="caption"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exercise1-getting-started.html"><strong>Exercise 1: Github &amp; Colab</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise2-signals_and_decisions.html"><strong>Exercise 2: Signals and decisions</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise3-cbgt_and_pred_prey.html"><strong>Exercise 3: CBGT networks and predator-prey dynamics</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Exercise 4: Foraging and reinforcement learning</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/CoAxLab/BIX-book/main?urlpath=tree/book/exercises/exercise4-foraging_and_rl.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/CoAxLab/BIX-book/blob/main/book/exercises/exercise4-foraging_and_rl.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/exercises/exercise4-foraging_and_rl.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise 4: Foraging and reinforcement learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">Getting started</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-foraging-57-pt">Section 1 - Foraging [57 pt]</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1-6-pt">Question 1.1 [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-code-cells-below-run-and-fill-in-code-as-needed-according-to-the-text-instructions-before-each-one-feel-free-to-refer-to-lab-7-for-help">In the code cells below, run and fill in code as needed according to the text instructions before each one. Feel free to refer to lab 7 for help.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-patchy-environment-5-pt">Create a new patchy environment [5 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-patchy-environment-3-pt">Visualize the patchy environment [3 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-agents-3-pt">Create the agents [3 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiments-5-pt">Run the experiments [5 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-proportion-of-time-spent-on-patches-4-pt">Visualize proportion of time spent on patches [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-total-reward-4-pt">Visualize total reward [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-agent-deaths-4-pt">Visualize agent deaths [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-2-7-pt">Question 1.2 [7 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3-1-8-pt">Question 1.3.1 [8 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3-2-8-pt">Question 1.3.2 [8 pt]</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-reinforcement-learning-43-pt">Section 2 - Reinforcement learning [43 pt]</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-this-new-changing-bandit-environment-6-pt">Create this new changing bandit environment [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-1-7-pt">Question 2.1 [7 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-reinforcement-learning-agents-4-pt">Creating the reinforcement learning agents [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiments-6-pt">Run the experiments [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-total-rewards-4-pt">Visualize total rewards [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-2-8-pt">Question 2.2 [8 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-3-8-pt">Question 2.3 [8 pt]</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-4-foraging-and-reinforcement-learning">
<h1><strong>Exercise 4: Foraging and reinforcement learning</strong><a class="headerlink" href="#exercise-4-foraging-and-reinforcement-learning" title="Permalink to this headline">#</a></h1>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h2>
<p>This homework will involve concepts from the labs we’ve gone over in class. Feel free to reference them as you complete the assignment.</p>
<p>This homework contains 2 sections:</p>
<ol class="arabic simple">
<li><p>Investigation of patchy environment random initialization effects on foraging agents with different strategies.</p></li>
<li><p>Investigation of various actor-critic agents in a new type of dynamic bandit task - one where one arm becomes <em>more</em> rewarding partway through each experiment.</p></li>
</ol>
<p>Fill out the code cells below and answer the questions to complete the assignment. Most of the programming is quite straightforward, as it is all based on code from the labs, which you can use/modify in this notebook.</p>
</section>
<hr class="docutils" />
<section id="section-1-foraging-57-pt">
<h2>Section 1 - Foraging [57 pt]<a class="headerlink" href="#section-1-foraging-57-pt" title="Permalink to this headline">#</a></h2>
<p>In Lab 7, you investigated how random search, chemotaxis, and infotaxis agents behaved in a “patchy” foraging environment. We didn’t get to testing out the effects of random initializations in class. In this section of the homework you will carry out that analysis.</p>
<p>Following the environment patches as bushes metaphor, different random seeds determine where the random bushes grow.</p>
<section id="question-1-1-6-pt">
<h3>Question 1.1 [6 pt]<a class="headerlink" href="#question-1-1-6-pt" title="Permalink to this headline">#</a></h3>
<p>Why is it important to check multiple random seeds when comparing foraging strategies in patchy environments?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="in-the-code-cells-below-run-and-fill-in-code-as-needed-according-to-the-text-instructions-before-each-one-feel-free-to-refer-to-lab-7-for-help">
<h3>In the code cells below, run and fill in code as needed according to the text instructions before each one. Feel free to refer to lab 7 for help.<a class="headerlink" href="#in-the-code-cells-below-run-and-fill-in-code-as-needed-according-to-the-text-instructions-before-each-one-feel-free-to-refer-to-lab-7-for-help" title="Permalink to this headline">#</a></h3>
<p>Change the directory to where we want to clone in the specific explorationlib code library branch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">content</span>
</pre></div>
</div>
</div>
</div>
<p>Clone in the <code class="docutils literal notranslate"><span class="pre">target-patch-dev</span></code> explorationlib branch (the branch that has our new patchy environment functions).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!git clone -b target-patch-dev https://github.com/coaxlab/explorationlib
</pre></div>
</div>
</div>
</div>
<p>Install some other supporting code libraries, like gym-maze, which some explorationlib simulated environment code relies on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">explorationlib</span>
</pre></div>
</div>
</div>
</div>
<p>Install some other supporting code libraries, like gym-maze, which some explorationlib simulated environment code relies on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install --upgrade git+https://github.com/MattChanTK/gym-maze.git
!pip install celluloid # for the gifs
</pre></div>
</div>
</div>
</div>
<p>Import specific modules from the libraries we loaded. We’ll use these modules to create and plot enviornments, run experiments with different exploration agents in these environments, visualize their behaviors, and evaluate their performance according to various metrics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import misc</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Vis - 1</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Exp</span>
<span class="kn">from</span> <span class="nn">explorationlib.run</span> <span class="kn">import</span> <span class="n">experiment</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_exp</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">save</span>

<span class="c1"># Agents</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">DiffusionGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">DiffusionDiscrete</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">GradientDiffusionGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">GradientDiffusionDiscrete</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">AccumulatorGradientGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">AccumulatorInfoGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">TruncatedLevyDiscrete</span>

<span class="c1"># Env</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">ScentGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">create_grid_scent</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">create_grid_scent_patches</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">uniform_targets</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">uniform_patch_targets</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">constant_values</span>

<span class="c1"># Vis - 2</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_position2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length_hist</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_targets2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_scent_grid</span>

<span class="c1"># Score</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">total_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">num_death</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">on_off_patch_time</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-new-patchy-environment-5-pt">
<h3>Create a new patchy environment [5 pt]<a class="headerlink" href="#create-a-new-patchy-environment-5-pt" title="Permalink to this headline">#</a></h3>
<p>In the code block below, set up a new patch environment like our foraging lab in the following way:</p>
<ul class="simple">
<li><p>Have there be 4 patches of 15 targets each.</p></li>
<li><p>Have each patch have radius 3.</p></li>
<li><p>Set the random seed to 1257.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-patchy-environment-3-pt">
<h3>Visualize the patchy environment [3 pt]<a class="headerlink" href="#visualize-the-patchy-environment-3-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, make a plot of the patchy environment you just made.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-the-agents-3-pt">
<h3>Create the agents [3 pt]<a class="headerlink" href="#create-the-agents-3-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, create a random search, chemotaxis, and infotaxis agent like we did in Lab 7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-experiments-5-pt">
<h3>Run the experiments [5 pt]<a class="headerlink" href="#run-the-experiments-5-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, run 50 experiments of 400 steps each for each of the agents. Note - you may have set the number of experiments and steps earlier during your environment setup code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-proportion-of-time-spent-on-patches-4-pt">
<h3>Visualize proportion of time spent on patches [4 pt]<a class="headerlink" href="#visualize-proportion-of-time-spent-on-patches-4-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below:</p>
<ul class="simple">
<li><p>Plot bar plots with error bars for the proportion of time spent on patches for each agent.</p></li>
<li><p>Plot a histogram for the proportion of time spent on patches for each agent.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-total-reward-4-pt">
<h3>Visualize total reward [4 pt]<a class="headerlink" href="#visualize-total-reward-4-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below:</p>
<ul class="simple">
<li><p>Plot bar plots with error bars for the total reward for each agent.</p></li>
<li><p>Plot a histogram of total reward for each agent.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-agent-deaths-4-pt">
<h3>Visualize agent deaths [4 pt]<a class="headerlink" href="#visualize-agent-deaths-4-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, plot a bar plot of the number of deaths for each agent type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-2-7-pt">
<h3>Question 1.2 [7 pt]<a class="headerlink" href="#question-1-2-7-pt" title="Permalink to this headline">#</a></h3>
<p>Describe the performance of each agent type according to each of the metrics (on-patch proportion, total reward, deaths). Why do you think this pattern of performance occured?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-3-1-8-pt">
<h3>Question 1.3.1 [8 pt]<a class="headerlink" href="#question-1-3-1-8-pt" title="Permalink to this headline">#</a></h3>
<p>Re-run your simulations above, but change the seed value for the random number generator. Do this four different times, once each with the following values: 2257, 3257, 4257, 5257.</p>
<p>What do you see in each performance metric of the agents with each new seed value (which specifies different unique environments)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answers here, as Python comments.</span>

<span class="c1"># --For seed 2257:--</span>


<span class="c1"># --For seed 3257:--</span>


<span class="c1"># --For seed 4257:--</span>


<span class="c1"># --For seed 5257:--</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-3-2-8-pt">
<h3>Question 1.3.2 [8 pt]<a class="headerlink" href="#question-1-3-2-8-pt" title="Permalink to this headline">#</a></h3>
<p>What does this (your results recorded in Question 1.3.1) tell you about the the difference between the Info and Chemo agents in particular in environments of this type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="section-2-reinforcement-learning-43-pt">
<h2>Section 2 - Reinforcement learning [43 pt]<a class="headerlink" href="#section-2-reinforcement-learning-43-pt" title="Permalink to this headline">#</a></h2>
<p>In the last part of lab 9, you investigated the performance of different reinforcement learnign agents in a changing bandit task, where an arm that used to give the most reward suddenly dropped in reward probability.</p>
<p>In this section of the homework, you will build and test reinforcement learning agents in a different changing bandit task - one where an arm that gave zero reward for most of the experiment changes to being rewarding at a very high probability near the end of each experiment.</p>
<p>Import necessary modules</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">explorationlib</span>

<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">BanditUniform4</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">BanditChange4</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">BanditActorCritic</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">Critic</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">CriticUCB</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">CriticNovelty</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">EpsilonActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">RandomActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">SequentialActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">SoftmaxActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">BoundedRandomActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">BoundedSequentialActor</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">DeterministicActor</span>

<span class="kn">from</span> <span class="nn">explorationlib.run</span> <span class="kn">import</span> <span class="n">experiment</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">total_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">action_entropy</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_exp</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">save</span>

<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_bandit</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_bandit_actions</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_bandit_critic</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_bandit_hist</span>
</pre></div>
</div>
</div>
</div>
<p>Set up for pretty plots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pretty plots</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span><span class="o">=</span><span class="s1">&#39;retina&#39;</span>
<span class="o">%</span><span class="n">config</span> <span class="n">IPCompleter</span><span class="o">.</span><span class="n">greedy</span><span class="o">=</span><span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;16&quot;</span>

<span class="c1"># Dev</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Plotting the structure of the new bandit task before and after the change</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shared env params</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">5030</span>

<span class="c1"># plot env before</span>
<span class="n">env1</span> <span class="o">=</span> <span class="n">BanditUniform4</span><span class="p">(</span><span class="n">p_min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p_best</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">env1</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">plot_bandit</span><span class="p">(</span><span class="n">env1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># plot env after</span>
<span class="n">env2</span> <span class="o">=</span> <span class="n">BanditUniform4</span><span class="p">(</span><span class="n">p_min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p_best</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">env2</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">plot_bandit</span><span class="p">(</span><span class="n">env2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="create-this-new-changing-bandit-environment-6-pt">
<h3>Create this new changing bandit environment [6 pt]<a class="headerlink" href="#create-this-new-changing-bandit-environment-6-pt" title="Permalink to this headline">#</a></h3>
<p>To make the environment described above, set up a BanditChange4 environment with the following parameters:</p>
<ul class="simple">
<li><p>Have the number of trials before the change be 150.</p></li>
<li><p>Have minimum and maximim probability of reward set to 0.1 and 0.3, respectively.</p></li>
<li><p>Have the probability of reward for the “best” arm actually set to 0.0.</p></li>
<li><p>Have the probability of reward for that arm after the change set to 0.9.</p></li>
<li><p>Set the environment’s seed to 5030.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-2-1-7-pt">
<h3>Question 2.1 [7 pt]<a class="headerlink" href="#question-2-1-7-pt" title="Permalink to this headline">#</a></h3>
<p>When testing later on, we will have each experiment last for 175 steps. What makes this a tricky problem? What would an agent have to do to succeed in this task?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-the-reinforcement-learning-agents-4-pt">
<h3>Creating the reinforcement learning agents [4 pt]<a class="headerlink" href="#creating-the-reinforcement-learning-agents-4-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, fill in the code for creating each agent. Use the settings from the lab (repeated here for ease):</p>
<ul class="simple">
<li><p>Random agent: no settings needed</p></li>
<li><p>Epsilon-greedy agent: use epsilon value of 0.1</p></li>
<li><p>Upper confidence bound agent: use bonus weight of 0.5</p></li>
<li><p>Softmax actor critic: use beta value of 7</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ran</span> <span class="o">=</span> <span class="n">BanditActorCritic</span><span class="p">(</span>
    <span class="c1"># Fill in random agent code here</span>
    
<span class="p">)</span>

<span class="n">epy</span> <span class="o">=</span> <span class="n">BanditActorCritic</span><span class="p">(</span>
    <span class="c1"># Fill in epsilon greedy agent code here</span>
    
<span class="p">)</span>

<span class="n">ucb</span> <span class="o">=</span> <span class="n">BanditActorCritic</span><span class="p">(</span>
    <span class="c1"># Fill in upper confidence bound agent code here</span>
    
<span class="p">)</span>

<span class="n">sft</span> <span class="o">=</span> <span class="n">BanditActorCritic</span><span class="p">(</span>
    <span class="c1"># Fill in softmax agent code here</span>
    
<span class="p">)</span>


<span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">ran</span><span class="p">,</span> <span class="n">epy</span><span class="p">,</span> <span class="n">ucb</span><span class="p">,</span> <span class="n">sft</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="s2">&quot;ep-greedy&quot;</span><span class="p">,</span> <span class="s2">&quot;upper conf. bound&quot;</span><span class="p">,</span> <span class="s2">&quot;softmax&quot;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-experiments-6-pt">
<h3>Run the experiments [6 pt]<a class="headerlink" href="#run-the-experiments-6-pt" title="Permalink to this headline">#</a></h3>
<p>Fill in the code cell below to run 500 experiments for each agent, each with 175 steps. Set the seed to 5030 (have a code line for <code class="docutils literal notranslate"><span class="pre">seed=5030,</span></code> after the code line that sets the number of experiments).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-total-rewards-4-pt">
<h3>Visualize total rewards [4 pt]<a class="headerlink" href="#visualize-total-rewards-4-pt" title="Permalink to this headline">#</a></h3>
<p>In the code cell below, add code to plot the total reward for each agent type in the experiements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-2-2-8-pt">
<h3>Question 2.2 [8 pt]<a class="headerlink" href="#question-2-2-8-pt" title="Permalink to this headline">#</a></h3>
<p>How did each of the agents do, compared to one another? Why do you think this is the case?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-2-3-8-pt">
<h3>Question 2.3 [8 pt]<a class="headerlink" href="#question-2-3-8-pt" title="Permalink to this headline">#</a></h3>
<p>Re-run just the experiments and reward plotting with the following random seeds: 6030, 7030, 8030, and 9030. Make sure you are just changing the seed for the experiments, not for the bandit task itself.</p>
<p>How consistent are the results you see? What does this tell you about the stability of the patterns you described in Question 2.2? Why do you think this is the case?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here, as a Python comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>IMPORTANT</strong> Did you collaborate with anyone on this assignment? If so, list their names here.</p>
<blockquote>
<div><p><em>Write Name(s) here</em></p>
</div></blockquote>
<p><strong>DUE:</strong> 5pm ET, Dec. 9, 2022. Email the link to the completed notebook on your Github repository to the TA and me via Canvas.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="exercise3-cbgt_and_pred_prey.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Exercise 3: CBGT networks and predator-prey dynamics</strong></p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">Getting started</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-foraging-57-pt">Section 1 - Foraging [57 pt]</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1-6-pt">Question 1.1 [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-code-cells-below-run-and-fill-in-code-as-needed-according-to-the-text-instructions-before-each-one-feel-free-to-refer-to-lab-7-for-help">In the code cells below, run and fill in code as needed according to the text instructions before each one. Feel free to refer to lab 7 for help.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-patchy-environment-5-pt">Create a new patchy environment [5 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-patchy-environment-3-pt">Visualize the patchy environment [3 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-agents-3-pt">Create the agents [3 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiments-5-pt">Run the experiments [5 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-proportion-of-time-spent-on-patches-4-pt">Visualize proportion of time spent on patches [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-total-reward-4-pt">Visualize total reward [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-agent-deaths-4-pt">Visualize agent deaths [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-2-7-pt">Question 1.2 [7 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3-1-8-pt">Question 1.3.1 [8 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3-2-8-pt">Question 1.3.2 [8 pt]</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-reinforcement-learning-43-pt">Section 2 - Reinforcement learning [43 pt]</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-this-new-changing-bandit-environment-6-pt">Create this new changing bandit environment [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-1-7-pt">Question 2.1 [7 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-reinforcement-learning-agents-4-pt">Creating the reinforcement learning agents [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiments-6-pt">Run the experiments [6 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-total-rewards-4-pt">Visualize total rewards [4 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-2-8-pt">Question 2.2 [8 pt]</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-3-8-pt">Question 2.3 [8 pt]</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Timothy Verstynen, Erik Peterson, Matthew Clapp, Jack Burgess
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>