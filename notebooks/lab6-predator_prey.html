

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lab 6 - Predator-prey dynamics &#8212; Biologically Intelligent eXploration (BIX)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/lab6-predator_prey';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 7 - Foraging" href="lab7-foraging.html" />
    <link rel="prev" title="Lab 5 - CBGT pathways" href="lab5-cbgt.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/levy-flight.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/levy-flight.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Biologically Intelligent eXploration (BIX)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro-python.html">Introduction to python</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lab1-randomsearch.html">Lab 1 - Random exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2-chemotaxis.html">Lab 2 - Simple Chemotaxis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab4-evidence_accumulation.html">Lab 4 - Evidence Accumulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5-cbgt.html">Lab 5 - CBGT pathways</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 6 - Predator-prey dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab7-foraging.html">Lab 7 - Foraging</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab9-reward_seeking.html">Lab 9 - Reward seeking</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab10-curiosity_driven_learning.html">Lab 10 - Curiosity-driven exploration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise1-getting-started.html"><strong>Exercise 1: Github &amp; Colab</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise2-signals_and_decisions.html"><strong>Exercise 2: Signals and decisions</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise3-cbgt_and_pred_prey.html"><strong>Exercise 3: CBGT networks and predator-prey dynamics</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise4-foraging_and_rl_and_info.html"><strong>Homework 4: Foraging and reinforcement learning</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/CoAxLab/BIX-book/main?urlpath=tree/book/notebooks/lab6-predator_prey.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/CoAxLab/BIX-book/blob/main/book/notebooks/lab6-predator_prey.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/lab6-predator_prey.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 6 - Predator-prey dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-needed-modules">Install and import needed modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-a-lone-hungry-coyote">Section 1 - A lone, hungry coyote</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-base-case">The base case</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1">Question 1.1</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-2">Question 1.2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eagle-eyes">Eagle eyes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3">Question 1.3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-5">Question 1.5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-fast-and-the">The fast and the….</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-6">Question 1.6</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-7">Question 1.7</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#range-anxiety">Range anxiety</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-8">Question 1.8</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-9">Question 1.9</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hunting-buddies">Hunting buddies</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-10">Question 1.10</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-11">Question 1.11</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-one-can-see-me">No one can see me!?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-12">Question 1.12</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-13">Question 1.13</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-life-is-in-your-hands-now">Section 2 - Life is in your hands now….</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge">Challenge</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-6-predator-prey-dynamics">
<h1>Lab 6 - Predator-prey dynamics<a class="headerlink" href="#lab-6-predator-prey-dynamics" title="Permalink to this heading">#</a></h1>
<p>In this assignment we study exploration for targets that can move. Prey, in other words. We also add uncertainty to their capture, with a probability of escape term, <em>p escape</em>. Think of this as a successful fleeing.</p>
<p>Our exploration strategies are once again random. We have no scent or memory as an aide.</p>
<p>The world is a grid world.</p>
<p>The lab has two sections.</p>
<ol class="arabic simple">
<li><p>We strart a demo mostly. We will explore speed, scale, detection, predator number, and escape. Here we have one predator (our explorer) and one prey (our target), well mostly.</p></li>
<li><p>We then go to challenge. This is where things get more interesting. We’ll change the venue. Make it bigger. Add more prey, and of different species. I’ll then award you with 10 “evolution points’’ that you can spend by increasing the number of predators, their speed, their movement scale, or their vision.</p></li>
</ol>
<p>Our metrics are metrics of death. We use two, but our focus is on their difference.</p>
<ul class="simple">
<li><p><em>Predator deaths</em>: Any experimental trial which does not lead to finding at least a single target (aka reward or prey) means the exploring agent (predator) dies. It’s a harsh noisy world we live in, after all.</p></li>
<li><p><em>Prey deaths</em>: The number of prey deaths is the number of targets found, which is the same as the number of rewards observed. However unlike past exploration tasks, once a prey (target) has been found it is removed from the field, and stays dead for the rest of that experiment. When the experiment resets, for each <em>num experiment</em>, all the targets spring back to life and the predator(s) get another chance.</p></li>
<li><p><em>Prey deaths - Predator deaths</em>: We’ll call this last value, the difference between deaths, the <em>fitness score</em>. More positive values are better. More negative values are worse.</p></li>
</ul>
<section id="install-and-import-needed-modules">
<h2>Install and import needed modules<a class="headerlink" href="#install-and-import-needed-modules" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install explorationlib?</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>git+https://github.com/CoAxLab/explorationlib
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>git+https://github.com/MattChanTK/gym-maze.git
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">explorationlib</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">DiffusionGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">LevyGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">FreezeLevyGrid</span>

<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">uniform_targets</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">constant_values</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">CompetitiveGrid</span>

<span class="kn">from</span> <span class="nn">explorationlib.run</span> <span class="kn">import</span> <span class="n">multi_experiment</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_exp</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_agent</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">save</span>

<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_position2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_positions2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length_hist</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_targets2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">show_gif</span>

<span class="kn">from</span> <span class="nn">explorationlib</span> <span class="kn">import</span> <span class="n">score</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">num_death</span>
<span class="c1"># from explorationlib.score import average_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">total_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">first_reward</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pretty plots</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
<span class="o">%</span><span class="k">config</span> IPCompleter.greedy=True
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;16&quot;</span>

<span class="c1"># Dev</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="section-1-a-lone-hungry-coyote">
<h2>Section 1 - A lone, hungry coyote<a class="headerlink" href="#section-1-a-lone-hungry-coyote" title="Permalink to this heading">#</a></h2>
<p>In this section we’ll study one explorer (predator) and one target (prey) noisy, as a base case. Both will be diffusion models, to start with anyway. They will start with the same movement scale, detection radius and speed. From there we’ll try some changes, to see what helps predators and <em>how much it helps.</em> We’ll see what helps the prey, and <em>how much</em>.</p>
<section id="the-base-case">
<h3>The base case<a class="headerlink" href="#the-base-case" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shared env params</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">seed_value</span> <span class="o">=</span> <span class="mi">559</span>

<span class="n">num_agents</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_targets</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">))</span>

<span class="n">detection_radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p_target</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p_escape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_target</span><span class="p">)</span>

<span class="n">target_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">step_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">min_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">detection_radius</span> <span class="o">=</span>  <span class="mi">1</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Create env </span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">num_agents</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="question-1-1">
<h4>Question 1.1<a class="headerlink" href="#question-1-1" title="Permalink to this heading">#</a></h4>
<p>We start with an equal match, scale, speed, number, on a small domain, with a detection radius that’s about 10 percent of the domain. Make a guess. Will the fitness score be a positive number on average, or a negative one? Explain yourself.</p>
<p>That is, does it even make sense to hunt alone when you don’t have any advantage?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. </span>
</pre></div>
</div>
</div>
</div>
<p>Let’s see if you were right</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Intial targets</span>
<span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
    <span class="n">target_index</span><span class="p">,</span> 
    <span class="n">targets</span><span class="p">,</span> 
    <span class="n">values</span><span class="p">,</span> 
    <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
    <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
<span class="p">)</span>

<span class="c1"># Preds</span>
<span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Preys</span>
<span class="n">prey</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span> 

<span class="c1"># All agents</span>
<span class="n">agents</span> <span class="o">=</span> <span class="n">prey</span> <span class="o">+</span> <span class="n">pred</span>

<span class="c1"># !</span>
<span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;base&quot;</span><span class="p">,</span>
    <span class="n">agents</span><span class="p">,</span> 
    <span class="n">env</span><span class="p">,</span>
    <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
    <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
    <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># -</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prey index : </span><span class="si">{</span><span class="n">target_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h3>
<p>Plot 5 example experiments of a predator search, prey evasion. Both are random walks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># Example bout</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_positions2d</span><span class="p">(</span>
        <span class="n">select_exp</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
        <span class="n">num_agents</span><span class="p">,</span>
        <span class="n">boundary</span><span class="o">=</span><span class="n">plot_boundary</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Prey</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">target_index</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Pred&quot;</span><span class="p">],</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_targets2d</span><span class="p">(</span>
        <span class="n">env</span><span class="p">,</span>
        <span class="n">boundary</span><span class="o">=</span><span class="n">plot_boundary</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Intial target&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="question-1-2">
<h4>Question 1.2<a class="headerlink" href="#question-1-2" title="Permalink to this heading">#</a></h4>
<p>Was you answer to Q 1.1 correct? Were you close? If you were wrong, or way off, please try an explain why. In what way did your intuition betray you?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="eagle-eyes">
<h3>Eagle eyes<a class="headerlink" href="#eagle-eyes" title="Permalink to this heading">#</a></h3>
<p>Here we will increase the detection radius up to five fold.</p>
<section id="question-1-3">
<h4>Question 1.3<a class="headerlink" href="#question-1-3" title="Permalink to this heading">#</a></h4>
<p>Make a guess. Will linear increases in vision (aka detection radius) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s find out. We’re going to increase detection radius in 5 steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection_radii</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detection_radii</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">detection_radii</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;vision_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vision radius&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vision radius&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vision radius&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-5">
<h4>Question 1.5<a class="headerlink" href="#question-1-5" title="Permalink to this heading">#</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="the-fast-and-the">
<h3>The fast and the….<a class="headerlink" href="#the-fast-and-the" title="Permalink to this heading">#</a></h3>
<p>Here we will increase the step size of the predator up to five fold. This is akin to increasing its speed relative to the target.</p>
<section id="question-1-6">
<h4>Question 1.6<a class="headerlink" href="#question-1-6" title="Permalink to this heading">#</a></h4>
<p>Make a guess. Will linear increases in speed (aka step size) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<p>Okay, now let’s take a look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_step_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_step_sizes</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">target_step_sizes</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">x</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;speed_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Speed&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Speed&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Speed&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-7">
<h4>Question 1.7<a class="headerlink" href="#question-1-7" title="Permalink to this heading">#</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as a comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="range-anxiety">
<h3>Range anxiety<a class="headerlink" href="#range-anxiety" title="Permalink to this heading">#</a></h3>
<p>Here we will increase the range/scale of the predator up to five fold. This is akin to increasing how far it will travel in a fixed time interval.</p>
<section id="question-1-8">
<h4>Question 1.8<a class="headerlink" href="#question-1-8" title="Permalink to this heading">#</a></h4>
<p>Make a guess. Will linear increases in exploration range (aka scale) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as a comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_scales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_scales</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">pred_scales</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;scale_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Range&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Range&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Range&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-9">
<h4>Question 1.9<a class="headerlink" href="#question-1-9" title="Permalink to this heading">#</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hunting-buddies">
<h3>Hunting buddies<a class="headerlink" href="#hunting-buddies" title="Permalink to this heading">#</a></h3>
<p>Will adding more predators help? If, that is, everything else is the same as our base case.</p>
<section id="question-1-10">
<h4>Question 1.10<a class="headerlink" href="#question-1-10" title="Permalink to this heading">#</a></h4>
<p>Make a guess. Will linear increases in predators give a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<p>Time to take a look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_predators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_predators</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">num_predators</span><span class="p">):</span>
    <span class="n">x_num_agents</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>
    <span class="n">x_num_targets</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x_target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_num_targets</span><span class="p">))</span>

    <span class="c1"># Create env </span>
    <span class="n">x_env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">x_num_agents</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">x_num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
    <span class="n">x_values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">x_targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Intial targets</span>
    <span class="n">x_env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">x_target_index</span><span class="p">,</span> 
        <span class="n">x_targets</span><span class="p">,</span> 
        <span class="n">x_values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> <span class="o">*</span> <span class="n">x</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;pred_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">x_env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num predators&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num predators&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num predators&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-11">
<h4>Question 1.11<a class="headerlink" href="#question-1-11" title="Permalink to this heading">#</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="no-one-can-see-me">
<h3>No one can see me!?<a class="headerlink" href="#no-one-can-see-me" title="Permalink to this heading">#</a></h3>
<p>Here we will increase the prey’s ability to escape, <em>p escape</em>.</p>
<section id="question-1-12">
<h4>Question 1.12<a class="headerlink" href="#question-1-12" title="Permalink to this heading">#</a></h4>
<p>Make a guess. Will linear increases to p escape give a linear decrease in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<p>Good luck prey!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_escapes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_escapes</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">p_escapes</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;escape_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;p escape&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;p escape&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;p escape&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-1-13">
<h4>Question 1.13<a class="headerlink" href="#question-1-13" title="Permalink to this heading">#</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="section-2-life-is-in-your-hands-now">
<h2>Section 2 - Life is in your hands now….<a class="headerlink" href="#section-2-life-is-in-your-hands-now" title="Permalink to this heading">#</a></h2>
<p>Okay, now let’s play a game for some extra credit. We’ll award you 10 “evolutionary” points. You can spend them on four parametrers: step size, scale, num_predators. The domain is now bigger, and the are 12 prey of three different “species”. <strong>Do not change any parameters but the four listed.</strong></p>
</section>
<section id="challenge">
<h2>Challenge<a class="headerlink" href="#challenge" title="Permalink to this heading">#</a></h2>
<p>The challenge is to find the <strong>best</strong> way to spend the 10 points so as to maximize the fitness (i.e., prey - predators).</p>
<p>Play around with combinations of values to find the best fitness possible. Save the notebook and submit it for 2pts of extra credit on your final grade. Whoever submits the highest fitness score gets an extra 2pts on their final grade.</p>
<p><strong>NOTE:</strong> Do not go over 10 total points or else you will be disqualified and receive no extra credit. Do not change any other parameters or else you will be disqualified and receive no credit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Explain your hypothesis/guess here....</span>


<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Spend here ONLY (count the points carefully)</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">detection_radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_predators</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># DO NOT TOUCH ANYTHING ELSE BELOW</span>
<span class="c1"># ---------------------------------------------------------------------------------</span>

<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Run</span>
<span class="n">min_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Fast</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="c1"># Flight</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="c1"># Freeze</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">)</span>
<span class="p">]</span> 

<span class="c1"># Shared env params</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">seed_value</span> <span class="o">=</span> <span class="mi">559</span>

<span class="n">num_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">preys</span><span class="p">)</span>
<span class="n">target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">))</span>
<span class="n">num_agents</span> <span class="o">=</span> <span class="n">num_predators</span> <span class="o">+</span> <span class="n">num_targets</span>

<span class="n">p_target</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">target_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Create env </span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">num_agents</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Run</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Intial targets</span>
<span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
    <span class="n">target_index</span><span class="p">,</span> 
    <span class="n">targets</span><span class="p">,</span> 
    <span class="n">values</span><span class="p">,</span> 
    <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
    <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Preds</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
    <span class="p">)</span>
<span class="p">]</span> <span class="o">*</span> <span class="n">num_predators</span>

<span class="c1"># All agents</span>
<span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">preds</span>

<span class="c1"># !</span>
<span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
    <span class="n">agents</span><span class="p">,</span> 
    <span class="n">env</span><span class="p">,</span>
    <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
    <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
    <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>

<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="c1"># Report</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The fitness was </span><span class="si">{</span><span class="n">fitness</span><span class="si">}</span><span class="s2"> (max score is </span><span class="si">{</span><span class="n">num_experiments</span><span class="o">*</span><span class="n">num_targets</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lab5-cbgt.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 5 - CBGT pathways</p>
      </div>
    </a>
    <a class="right-next"
       href="lab7-foraging.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 7 - Foraging</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-needed-modules">Install and import needed modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-a-lone-hungry-coyote">Section 1 - A lone, hungry coyote</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-base-case">The base case</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1">Question 1.1</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-2">Question 1.2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eagle-eyes">Eagle eyes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-3">Question 1.3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-5">Question 1.5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-fast-and-the">The fast and the….</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-6">Question 1.6</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-7">Question 1.7</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#range-anxiety">Range anxiety</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-8">Question 1.8</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-9">Question 1.9</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hunting-buddies">Hunting buddies</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-10">Question 1.10</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-11">Question 1.11</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-one-can-see-me">No one can see me!?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-12">Question 1.12</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-13">Question 1.13</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-life-is-in-your-hands-now">Section 2 - Life is in your hands now….</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge">Challenge</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Timothy Verstynen, Erik Peterson, Matthew Clapp, Jack Burgess
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>